<!DOCTYPE html>
<html>

<head>
    <title>K-quest - Профиль</title>
    
    <link rel="stylesheet" href="{{ url_for('static',filename = 'styles/common.css')}}">
    <link rel="stylesheet" href="{{ url_for('static',filename = 'styles/profile.css')}}">

    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400&display=swap" rel="stylesheet">

    <script src="{{ url_for('static',filename = 'scripts/profileinteract.js')}}"></script>
    <script src="{{ url_for('static',filename = 'scripts/background.js')}}"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

</head>

<body>

    <!--Оформление заднего фона-->
    <div class="wrapper">
        <!--Шапка-->
        <div class="header">
            <!--Содержимое шапки-->
            <div class="headerContent">
                <a id="HomeRef" 
                    onclick="window.location = 'http://127.0.0.1:5000/'">K-quest</a>
            </div>
            <div>
                <img style="width:50px; height:50px;" src="{{ url_for('static',filename = 'images/profileicon.png')}}" alt="">
            </div>
        </div>

        <!--Основной контент-->
        <div class="profile">
            <!--Навигационная панель-->
            <div class="sidebar">
                <!--Имя пользователя-->
                <div class="sidebarSection" style="top: 48px; border-radius:30px;">
                    <div class="wrapperSideBarSection">
                        <a style="font-size: 24px; font-weight: 700;" onclick="openSection('edit')">{{data[0]}}</a>
                        <img src="{{ url_for('static',filename = 'images/user-pen.svg')}}" onclick="openSection('edit')">
                    </div>
                </div>

                <!--Пройденные-->
                <div class=" sidebarSection ListsOpenRef" id="sidebarSectionPassed" style="top: 128px;">
                    <div class="wrapperSideBarSection">
                        <a  style="font-weight: 500;" onclick="openSection('passed')">Пройденные квесты</a>
                    </div>
                </div>

                <!--Созданные-->
                <div class="sidebarSection ListsOpenRef" id="sidebarSectionMade" style="top: 182px;">
                    <div class="wrapperSideBarSection">
                        <a style="font-weight: 500;" onclick="openSection('made')">Созданные квесты</a>
                        <img src="{{ url_for('static',filename = 'images/add.svg')}}" onclick="openSection('made')">
                    </div>
                </div>

                <!--Выход-->
                <div class="sidebarSection signoutSideBarSection" style="align-self: flex-end">
                    <div >
                        <img src="{{ url_for('static',filename = 'images/sign-out-alt.svg')}}" style="margin: 0 0 16px 0;" onclick="window.location = 'http://127.0.0.1:5000/dropsession'">
                    </div>
                </div>
            </div>

            <!--Содержание выбранной секции-->
            <div class="menu">
                <!--Редактирование профиля-->
                <div id="edit">
                    <form method="post" action="/profile/edit">
                        <div class="editSection">
                            <div>
                                <h3>Ник</h3>
                                <input type="text" name="newnickname" placeholder="{{data[2]}}" ></input>
                            </div>
                        </div>

                        <div class="editSection">
                            <div>
                                <h3>Логин</h3>
                                <input type="text" name="login" placeholder="{{data[0]}}" readonly></input>
                            </div>
                            <div>
                                <h3>Пароль</h3>
                                <input type="text" name="newpassword" placeholder="Пароль"></input>
                            </div>
                        </div>

                        <div class="editSection">
<!--                            <div>-->
<!--                                <h3>Секретный вопрос</h3>-->
<!--                                <select name="securityQuestion[]">-->
<!--                                    <option value="" disabled selected>Секретный вопрос</option>-->
<!--                                    <option value="1">Вопрос 1</option>-->
<!--                                    <option value="2">Вопрос 2</option>-->
<!--                                    <option value="3">Вопрос 3</option>-->
<!--                                </select>-->
<!--                            </div>-->
                            <div>
                                <h3>Секретный вопрос</h3>
                                <input type="text" placeholder= "{{data[3]}}" readonly></input>
                            </div>
                            <div>
                                <h3>Ответ на секретный вопрос</h3>
                                <input type="text" name="securityAnswer" placeholder="************"></input>
                            </div>
                        </div>

                        <div class="editSection" style="margin-top: 64px">
                            <div style="display: flex; align-items: center;">
                                
                                <div class ="div-animd-btn-wrapper">
                                    
                                    <button class="animated-btn" onclick="window.location = 'http://127.0.0.1:5000/profile/edit'" id="btnUpdateProfile">
                                        <img style="color:black;" src="{{ url_for('static',filename = 'images/savechangesicon.svg')}}" width="24" height="24">Сохранить
                                        изменения</button>
                                    <a style="margin-left: 24px; font-size: 20px; " onclick="openDeletionConfirmation()">Удалить
                                    аккаунт</a>
                                </div>
                                
                                
                                
                            </div>
                        </div>
                    </form>
                </div>

                <!--Пройденные квесты-->
                <div id="passed">
                    {% for el in qprog|reverse %}
                    <div id="listEntry">
                            <h2 id="EndCodeQuest" >{{el[0]}}</h2>
                            <a id="passedEntryName" style="margin-left: 15px">{{el[1]}}</a>
                    </div>
                    {% endfor %}



                </div>

                <div id="made">
                    {% for el in lquests|reverse %}
                        <div id="listEntry">
                            
                            <h2 id="CodeQuest" style=" margin-right: 15px;">{{el[0]}}</h2>
                                <button id="copy" onclick="copyText()" class="copy" style="background: #ffffffb5;">
                                     <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
                                        <script>
                                          $(document).ready(function() {
                                            $('#copy').click(function() {
                                              var text = $('#CodeQuest').text();
                                              var input = $('<textarea>').val(text).appendTo('body').select();
                                              document.execCommand('copy');
                                              input.remove();
                                            });
                                          });
                                        </script>
                                  <span style= "margin-top: -50px;" data-text-end="Copied!" data-text-initial="Copy to clipboard" class="tooltip"></span>
                                  <span id="span1">
                                    <svg  xml:space="preserve" style="enable-background:new 0 0 512 512" viewBox="0 0 6.35 6.35" y="0" x="0" height="20" width="20" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xmlns="http://www.w3.org/2000/svg" class="clipboard">
                                      <g>
                                        <path d="M2.43.265c-.3 0-.548.236-.573.53h-.328a.74.74 0 0 0-.735.734v3.822a.74.74 0 0 0 .735.734H4.82a.74.74 0 0 0 .735-.734V1.529a.74.74 0 0 0-.735-.735h-.328a.58.58 0 0 0-.573-.53zm0 .529h1.49c.032 0 .049.017.049.049v.431c0 .032-.017.049-.049.049H2.43c-.032 0-.05-.017-.05-.049V.843c0-.032.018-.05.05-.05zm-.901.53h.328c.026.292.274.528.573.528h1.49a.58.58 0 0 0 .573-.529h.328a.2.2 0 0 1 .206.206v3.822a.2.2 0 0 1-.206.205H1.53a.2.2 0 0 1-.206-.205V1.529a.2.2 0 0 1 .206-.206z"></path>
                                      </g>
                                    </svg>
                                    <svg id="YesCheckBox" xml:space="preserve" style="enable-background:new 0 0 512 512" viewBox="0 0 24 24" y="0" x="0" height="18" width="18" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" xmlns="http://www.w3.org/2000/svg" class="checkmark">
                                      <g>
                                        <path data-original="#000000" d="M9.707 19.121a.997.997 0 0 1-1.414 0l-5.646-5.647a1.5 1.5 0 0 1 0-2.121l.707-.707a1.5 1.5 0 0 1 2.121 0L9 14.171l9.525-9.525a1.5 1.5 0 0 1 2.121 0l.707.707a1.5 1.5 0 0 1 0 2.121z"></path>
                                      </g>
                                    </svg>
                                  </span>
                                </button>
                            <a id="madeEntryName" style="margin-left: 15px">Квест "{{el[1]}}"</a>
                            <div class="funcsMadeQuests" style=" margin-left: auto; width: fit-content">
                                <img src="{{ url_for('static',filename = 'images/user.svg')}}" onclick="openSection('participants');players('{{el[0]}}')">
                            </div>
                            <div class="funcsMadeQuests" style="margin:0 15px 0 15px;">
                                <img src="{{ url_for('static',filename = 'images/edit.svg')}}" onclick="window.location = 'http://127.0.0.1:5000/create/edit/' + '{{el[2]}}' + '/' + '{{el[0]}}'">
                            </div>
                            <div class="funcsMadeQuests">
                                <img src="{{ url_for('static',filename = 'images/trash.svg')}}" onclick="openDeleteQuestConfirmation('{{el[0]}}')">
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <div id="participants">

                    <div id="listEntry">
                        <a id="passedEntryName">Пользователь "номер 1"</a>
                    </div>

                    <div id="listEntry">
                        <a id="passedEntryName">Пользователь "номер 2"</a>
                    </div>
                    <div id="listEntry">
                        <a id="passedEntryName">Пользователь "номер 3"</a>
                    </div>
                </div>
            </div>
        </div>

        <!--Сплывающее окно удаления аккаунта-->
        <div id="deletionConfirmation">
            <form method="post" action="/profile/del">
                <h2 style="color: black; font-weight: 100; font-size: 2.5vh; margin-top: 7.5vh">Вы уверены, что хотите
                    удалить
                    аккаунт?</h2>

                <div style="display: flex; margin: 4vh auto;  justify-content: center; align-items: center;">
                    <button class="animated-btn fancyBtn" id="btnConfirmDelete" type="submit" onclick="window.location = 'http://127.0.0.1:5000/profile/del'">
                        Удалить аккаунт
                    </button>
                    <a style="font-size: 2.5vh; padding: 0 0; margin: 0 2vw" onclick="closeMenu()">Отмена</a>
                </div>
            </form>
        </div>
    </div>

    <div id="QuestConfirmation">
        <h2 style="color: black; font-weight: 100; font-size: 2.5vh; margin-top: 7.5vh">Вы уверены, что хотите удалить этот квест?</h2>
        <div style="display: flex; margin: 4vh auto;  justify-content: center; align-items: center;">
            <button class="animated-btn fancyBtn" id="btnConfirmQuestDelete">Удалить квест</button>
            <a style="font-size: 2.5vh; padding: 0 0; margin: 0 2vw;color:black;" onclick="closeMenu()">Отмена</a>
        </div>
    </div>

    <!--Затенение фона-->
    <div id="blurBg" onclick="closeMenu()"></div>
<!--    <div id="create_data" new_quest={{ newdata }} style="display: none;">{{ newdata }}</div>-->
    <canvas class="background" ></canvas>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particlesjs/2.2.3/particles.min.js"></script>
</body>

</html>